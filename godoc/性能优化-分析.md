

系统 性能定义（ 如果你不知道哪些东西影响系统性能 你肯定不知道去哪里定位 @小罗童鞋）
1. Throughput ，吞吐量。也就是每秒钟可以处理的请求数，任务数
2. Latency， 系统延迟。也就是系统在处理一个请求或一个任务时的延迟。

    一般情况 都是这种情况
* Throughput越大，Latency会越差。因为请求量过大，系统太繁忙，所以响应速度自然会低。（比如 请求过多，nginx 层会把请求挂到队列层,再多的话可能直接舍弃掉。这取决于nginx 配置）
* Latency越好，能支持的Throughput就会越高。因为Latency短说明处理速度快，于是就可以处理更多的请求。

系统性能测试

我们知道要测试系统的性能，需要我们收集系统的Throughput和Latency这两个值。

latency 的响应耗时 根据业务来定义-比如 10ms 50ms 100ms  都可以
首先 我们需要制造大量的吞吐量来测试指标-、、、（压力测试  有很多，自行搜索。）
系统延迟的话 在代码层次 打log 就可以,不过这种知识程序内部的执行时间, 没有测试到操作系统,网络延迟 等情况。可以用wireshare ,charles 抓包看下
最后 工具准备好开始性能测试 -慢慢提高 不断测试 观察系统负载。当吞吐量越来越大时，系统的Latency会出现非常剧烈的抖动，所以，我们在测量Latency的时候，我们需要注意到Latency的分布，

定位性能瓶颈

查看操作系统负载 （top、iftop, iptraf, ntop, tcpdump、ps-ef）| cpu利用率和IO反比  | 多核的话 CPU0 还负责调度其他核



系统瓶颈 一般怎么优化 调优 呢？


1. 用空间换时间，比如 db 冗余数据 ,数据缓存,REDIS/MC ,web端的话CDN-
2. 空间换时间—这种 没了解过-不清楚
3. 代码级别的优化-PHP/GO 优化 这点你没必要知道。。可以用异步async
4. 并行处理-因为php 单进程-  可以开启多个php-cli 参数不同 来控制脚本，做成一个假并行- | 用Go实现 协程
5. 算法调优---一般没遇到-
6. 网络 优化-TCP/UDP这边都nginx 层/底层 处理了 运维搞-不太接触
7. 数据库优化—比较重要~~ 数据库锁/并发情况-DB会锁库,要了解各类 如行锁，表锁，页锁，读写锁，事务锁，以及各种写优先还是读优先机制，性能最高的是不要锁，所以，分库分表，冗余数据，减少一致性事务处理，可以有效地提高性能。NoSQL就是牺牲了一致性和事务处理，并冗余数据，从而达到了分布式和高性能
8. 数据库的存储机制，引擎存储方式-分区-字段-空间-好的数据库设计 能减少大量I/O、主流引擎是MyIsam/INNODB - 了解下底层存储吧。B-树、针对不同业务设计也不太一样-
9. 数据库的分布式策略-    比如 主主同步-主从同步- 了解技术实现的原理-做到水平扩容-
10. SQL 语句优化-explain 应该和你说过。慢慢分析 、  怎么优化???举几个case| 不要对索引字段做计算-转换-空值判断-函数-连接 等操作，会破坏性能-|Query 建议用到索引-或者 根据query 语句 重建索引-| 场景2：分页查询。一般都order by limit 。这种不好-为什么？ 因为Mysql 用的是offset. 还是全量查询然后 排序-分割-建议 where id>第几页的初始值-会好用很多-| 能用数字用数字-| 如果有全文检索的场景 -建议用sphinx -一般在网站全站索引- 坚决不用like
11. 继续上边的,还有一点，索引太多,insert delete 会很慢。 update的话 取决于你update 的索引数量, 如果update 两个索引,影响2个索引表
12. 还有很多—等等在写
